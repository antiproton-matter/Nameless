# === VYTVO≈òEN√ç C√çLOV√â SLO≈ΩKY ===
$desktop = [Environment]::GetFolderPath("Desktop")
$targetFolder = Join-Path $desktop "CookiesZalohy"
New-Item -ItemType Directory -Path $targetFolder -Force | Out-Null

# === Z√ÅKLADN√ç CESTY ===
$local = $env:LOCALAPPDATA
$roaming = $env:APPDATA

# === DEFINICE PODPOROVAN√ùCH PROHL√ç≈ΩEƒå≈Æ ===
$browsers = @(
    @{
        Name = "Chrome"
        Path = "$local\Google\Chrome\User Data\Default"
        Files = @("Cookies", "Local State")
    },
    @{
        Name = "Edge"
        Path = "$local\Microsoft\Edge\User Data\Default"
        Files = @("Cookies", "Local State")
    },
    @{
        Name = "Opera"
        Path = "$local\Opera Software\Opera Stable"
        Files = @("Cookies", "Local State")
    },
    @{
        Name = "Firefox"
        Path = "$roaming\Mozilla\Firefox\Profiles"
        Match = "*.default-release"
        Files = @("cookies.sqlite", "key4.db", "logins.json", "cert9.db")
    }
)

# === ZPRACOV√ÅN√ç PRO KA≈ΩD√ù PROHL√ç≈ΩEƒå ===
foreach ($browser in $browsers) {
    $name = $browser.Name
    $profilePath = $browser.Path

    # === FIREFOX: NAJDI AKTU√ÅLN√ç PROFIL ===
    if ($name -eq "Firefox") {
        if (Test-Path $profilePath) {
            $profileFolder = Get-ChildItem $profilePath -Directory | Where-Object { $_.Name -like $browser.Match } | Select-Object -First 1
            if ($profileFolder) {
                $profilePath = Join-Path $profilePath $profileFolder.Name
            } else {
                Write-Host "‚ö†Ô∏è Firefox profil nebyl nalezen."
                continue
            }
        } else {
            continue
        }
    }

    # === Z√ÅLOHOV√ÅN√ç SOUBOR≈Æ ===
    if (Test-Path $profilePath) {
        $dest = Join-Path $targetFolder $name
        New-Item -ItemType Directory -Path $dest -Force | Out-Null

        foreach ($file in $browser.Files) {
            $src = Join-Path $profilePath $file
            if (Test-Path $src) {
                try {
                    Copy-Item -Path $src -Destination $dest -Force
                    Write-Host "‚úÖ $name: Zkop√≠rov√°n soubor '$file'"
                } catch {
                    Write-Warning "‚ùå $name: Chyba p≈ôi kop√≠rov√°n√≠ '$file'"
                }
            } else {
                Write-Warning "‚ö†Ô∏è $name: Soubor '$file' nenalezen"
            }
        }
    } else {
        Write-Warning "‚ö†Ô∏è $name: Profilov√° slo≈æka nenalezena"
    }
}

Write-Host "`nüéâ Hotovo! V≈°e je ulo≈æeno ve slo≈æce '$targetFolder'"
